(()=>{function e(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,a,r,l,i=[],c=!0,d=!1;try{if(r=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(o=r.call(n)).done)&&(i.push(o.value),i.length!==t);c=!0);}catch(e){d=!0,a=e}finally{try{if(!c&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(d)throw a}}return i}}(e,n)||function(e,n){if(e){if("string"==typeof e)return t(e,n);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?t(e,n):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}document.addEventListener("DOMContentLoaded",(function(){var t=d3.select("svg");t.attr("overflow","hidden");var n=document.querySelector(".instruction-box p");console.log("Selected Element:",n),document.getElementById("visualization"),document.querySelectorAll('input[type="number"]').forEach((function(e){e.addEventListener("input",(function(t){I(e.id);var n=t.target.value;M(e.id,n,{rowName:"Manual",columnName:"Input"})}))}));var o=t.node().getBoundingClientRect().width,a=t.node().getBoundingClientRect().height,r=3,l=10,i=5,c=20,d=6,u=5,s="polygon",m=5,p=t.append("g").attr("id","rulers"),v=t.append("g").attr("id","shapes"),g=t.append("g"),f=96/2.54;S(1);var h=document.querySelector(".legend").offsetHeight,y=t.node().getBoundingClientRect().width,E=t.node().getBoundingClientRect().height-h;t.append("defs").append("clipPath").attr("id","clip").append("rect").attr("width",y).attr("height",E),v.attr("clip-path","url(#clip)"),v.attr("clip-path","url(#clip)");var b=d3.zoom().scaleExtent([.1,10]).on("zoom",(function(e){g.attr("transform",e.transform),S(e.transform.k)}));function w(e){e.preventDefault()}function S(e){p.selectAll("*").remove();for(var t=f*e,n=o/t,r=a/t,l=0;l<=n;l++){var i=l*t;p.append("line").attr("x1",i).attr("y1",10).attr("x2",i).attr("y2",0).attr("stroke","black"),l%1==0&&p.append("text").attr("x",i).attr("y",20).text(l).attr("font-size","10px").attr("text-anchor","middle")}for(var c=0;c<=r;c++){var d=c*t;p.append("line").attr("x1",5).attr("y1",d).attr("x2",15).attr("y2",d).attr("stroke","black"),c%1==0&&p.append("text").attr("x",20).attr("y",d).text(c).attr("font-size","10px").attr("text-anchor","start").attr("alignment-baseline","middle")}}t.call(b),document.querySelectorAll('input[type="number"]').forEach((function(e){e.addEventListener("input",(function(){var t,n;(n=(t=e).nextElementSibling)&&n.classList.contains("column-header-indicator")&&(n.remove(),t.style.width="100%")}))})),console.log("Computed Width:",o),console.log("Computed Height:",a),tippy("th",{content:"Click to divide the values in this column",placement:"top",allowHTML:!0,animation:"scale",arrow:!0}),tippy(".info-icon",{placement:"right",allowHTML:!0,animation:"scale",arrow:!0}),tippy(".info-icon2",{onShow:function(e){console.log(e.content)},placement:"top",allowHTML:!0,animation:"scale",arrow:!0});var x=function(){var e=t.node().getBoundingClientRect().width,n=t.node().getBoundingClientRect().height;g.attr("transform","translate(".concat(e/2,", ").concat(n/2,")"))};x(),document.getElementById("legendDesign1").innerText="Legend";var q=document.getElementById("divider"),L=!1;function I(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=document.querySelector("#legend".concat(T()));if(e){var n=t.querySelector('div[data-input="'.concat(e,'"]'));n&&n.remove()}else t.querySelectorAll("div[data-input]").forEach((function(e){e.remove()}))}function C(){document.querySelector("#poly-sides").value=3,document.querySelector("#size").value=10,document.querySelector("#loop-number").value=5,document.querySelector("#loop-width").value=20,document.querySelector("#joint-number").value=6,document.querySelector("#joint-width").value=5}function B(){document.querySelector("#radius").value=50,document.querySelector("#loop-number").value=5,document.querySelector("#loop-width").value=20,document.querySelector("#joint-number").value=6,document.querySelector("#joint-width").value=5}function k(){document.querySelector("#ellipse-width").value=30,document.querySelector("#ellipse-height").value=50,document.querySelector("#loop-number").value=5,document.querySelector("#loop-width").value=20,document.querySelector("#joint-number").value=6,document.querySelector("#joint-width").value=5}function A(){document.querySelector("#line-height").value=300,document.querySelector("#loop-number").value=5,document.querySelector("#loop-width").value=20,document.querySelector("#joint-number").value=6,document.querySelector("#joint-width").value=5}function M(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};console.log("Updating visualization:",e,"New Value:",t,"Meta:",n),W(),isDragDrop?j(e,"".concat(n.rowName,"'s ").concat(n.columnName,": ").concat(t),!0):j(e,"Manual Input: ".concat(t),!1)}function j(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a="legend"+T(),r=document.querySelector("#".concat(a)),l=document.getElementById(e).getAttribute("data-label"),i=r.querySelector('div[data-input="'.concat(e,'"]'));if(i&&r.removeChild(i),n){var c="".concat(l," represents ").concat(t),d=document.createElement("div");d.setAttribute("data-input",e),d.textContent=c,r.appendChild(d)}if(o){var u=document.createElement("div");u.textContent=o,r.appendChild(u)}}function N(e,t,n){e=Math.round(e);var o=2*Math.PI/e,a=2*Math.PI*t,r=a/d,l=(Math.PI,Array.from({length:e},(function(e,n){return[Math.cos(n*o)*t,Math.sin(n*o)*t]})));g.append("path").attr("d",d3.line()(l)+"Z").attr("stroke","black").attr("fill","none");for(var i=0;i<d;i++)for(var c=i*r+n*a,s=0,m=0;m<e;m++){var p=l[m],v=l[(m+1)%e],f=Math.sqrt(Math.pow(v[0]-p[0],2)+Math.pow(v[1]-p[1],2));if(s+f>c){var h=(c-s)/f,y=p[0]+(v[0]-p[0])*h,E=p[1]+(v[1]-p[1])*h;g.append("circle").attr("cx",y).attr("cy",E).attr("r",u).attr("fill","white");break}s+=f}U()}function z(){console.log("Inside drawCircle function"),g.selectAll("*").remove();var e=+document.getElementById("radius").value||50,t=+document.getElementById("arc-extent").value||360;t<=0?t=.1:t>=360&&(t=359.9);for(var n=t*Math.PI/180/(d-1),o=n/2,a=(+document.getElementById("arc-orientation").value||0)*(Math.PI/180),r=0;r<i;r++){var l=e+c*r,s=r%2*o,m=Math.cos(a)*l,p=Math.sin(a)*l,v=Math.cos(t*Math.PI/180+a)*l,f=Math.sin(t*Math.PI/180+a)*l,h=t<=180?0:1,y="M ".concat(m," ").concat(p," A ").concat(l," ").concat(l," 0 ").concat(h," 1 ").concat(v," ").concat(f);console.log("startX:",m,"startY:",p,"currentRadius:",l,"largeArcFlag:",h,"endX:",v,"endY:",f),g.append("path").attr("d",y).attr("fill","none").attr("stroke","black"),console.log("Path Data:",y);for(var E=0;E<d;E++){var b=E*n+s+a,w=Math.cos(b)*l,S=Math.sin(b)*l;g.append("circle").attr("cx",w).attr("cy",S).attr("r",u).attr("fill","white")}U()}}function D(){console.log("Inside drawEllipse function"),g.selectAll("*").remove();var e=+document.getElementById("ellipse-orientation").value||0,t=+document.getElementById("ellipse-extent").value||360,n=+document.getElementById("ellipse-width").value||50,o=+document.getElementById("ellipse-height").value||50;t<=0?t=.1:t>=360&&(t=359.9);for(var a=e*(Math.PI/180),r=0;r<i;r++){var l=n+c*r,s=o+c*r,m=r%2==0?0:Math.PI/d,p=l*Math.cos(a),v=s*Math.sin(a),f=l*Math.cos(a+t*Math.PI/180),h=s*Math.sin(a+t*Math.PI/180),y=t<=180?0:1,E="M ".concat(p," ").concat(v," A ").concat(l," ").concat(s," 0 ").concat(y," 1 ").concat(f," ").concat(h);if(g.append("path").attr("d",E).attr("fill","none").attr("stroke","black"),console.log("Path Data:",E),d>0)for(var b=t*Math.PI/180/(d-1),w=0;w<d;w++){var S=w*b+m+a,x=l*Math.cos(S),q=s*Math.sin(S);g.append("circle").attr("cx",x).attr("cy",q).attr("r",u).attr("fill","white")}}U()}function F(){!function(){var e=document.querySelector('.design[style="display: block;"]');console.log("Active Design:",e.id);var t=d3.select(e).select("svg");if(t.select("g").empty()){var n=document.querySelector(".visualization"),o=n.clientWidth/2,a=n.clientHeight/2;t.append("g").attr("transform","translate(".concat(o,",").concat(a,")"))}t.select("g").selectAll("*").remove(),t.select("text.legend").empty()&&t.append("text").attr("class","legend").attr("x",10).attr("y",t.node().getBoundingClientRect().height-10).attr("font-size","12px"),t.select("g")}(),v.selectAll("*").remove();var e=-50,t=-70,n=+document.getElementById("line-height").value;console.log("Height fetched from DOM:",n);var o=+document.getElementById("loop-number").value,a=+document.getElementById("loop-width").value,r=+document.getElementById("joint-number").value,l=+document.getElementById("joint-width").value;console.log("Loop Width fetched from DOM:",a),console.log("Joints fetched from DOM:",r),console.log("Joint Width fetched from DOM:",l),g.append("line").attr("x1",e).attr("y1",t).attr("x2",e).attr("y2",t+n).attr("stroke","black"),function(e,t,n,o,a){for(var r=1;r<=o;r++)g.append("line").attr("x1",e+r*a).attr("y1",t).attr("x2",e+r*a).attr("y2",t+n).attr("stroke","black"),console.log("Base line start:",e,t),console.log("Base line end:",e,t+n),console.log("Parallel line ".concat(r," start: ").concat(e+r*a,", ").concat(t)),console.log("Parallel line ".concat(r," end: ").concat(e+r*a,", ").concat(t+n));U()}(e,t,n,o,a),function(e,t,n,o,a,r,l){for(var i=n/(r+1),c=a,d=0;d<=o;d++)for(var u=d%2!=0,s=u?r+1:r,m=1;m<=s;m++){var p;p=u?(m-.5)*i-70:m*i-70,g.append("rect").attr("x",d*a-50-c/2).attr("y",p-l/2).attr("width",c).attr("height",l).attr("fill","white").attr("stroke","none"),console.log("Joint ".concat(m," on line ").concat(d,": x = ").concat(d*a-50,", y = ").concat(p))}}(0,0,n,o,a,r,l)}function T(){return document.querySelector('.design[style="display: block;"]').id}function P(e){var t=e.target,n=t.closest("tr");console.log("Drag Start on row:",n),document.querySelectorAll("#dataset-table tr:not(:first-child)").forEach((function(e){e!==n&&(e.classList.add("inactive-row"),console.log("Adding inactive-row to:",e))})),n.classList.add("active-row"),console.log("Adding active-row to:",n),t.classList.add("highlighted-cell"),e.dataTransfer.setData("text/plain",e.target.textContent),e.dataTransfer.setData("text/rowHeader",n.getAttribute("data-row-header")),e.dataTransfer.setData("text/columnHeader",e.target.getAttribute("data-column-header"))}q.addEventListener("mousedown",(function(e){e.preventDefault(),L=!0})),document.addEventListener("mousemove",(function(e){if(L){var t=document.body.offsetWidth-(e.clientX-document.body.offsetLeft),n=window.innerWidth-200;t>200&&t<n&&(document.querySelector(".right-section").style.width="".concat(t,"px"),document.querySelector(".left-section").style.width="calc(100% - ".concat(t,"px)"))}})),document.addEventListener("mouseup",(function(e){L=!1})),document.querySelector("#shape-selector").addEventListener("change",(function(e){switch(console.log("Shape changed to:",e.target.value),s=e.target.value){case"polygon":C(),N(r,l);break;case"circle":B(),z();break;case"ellipse":k(),D();break;case"line":A(),F();break;default:console.error("Unhandled shape type: ".concat(s))}document.querySelectorAll(".data-input").forEach((function(e){e.style.borderColor="",e.style.backgroundColor="",e.classList.remove("data-input"),e.classList.add("manual-input")})),console.log("Styles should be reset!")})),document.getElementById("startOverBtn").addEventListener("click",(function(){C(),B(),k(),A(),document.getElementById("ellipse-width").value=50,document.getElementById("ellipse-height").value=50,g.selectAll("*").remove(),I(),document.querySelectorAll(".data-input").forEach((function(e){e.style.borderColor="",e.style.backgroundColor="",e.classList.remove("data-input"),e.classList.add("manual-input")})),console.log("Styles should be reset!")})),document.querySelector("#radius").addEventListener("input",(function(e){var t=e.target.value;M("radius",t)})),document.querySelector("#arc-extent").addEventListener("input",(function(e){document.getElementById("arc-extent-display").textContent=e.target.value,z()})),document.querySelector("#arc-orientation").addEventListener("input",(function(e){document.getElementById("arc-orientation-display").textContent=e.target.value,z()})),document.querySelector("#loop-width").addEventListener("input",(function(e){c=+e.target.value,z()})),document.querySelector("#joint-width").addEventListener("input",(function(e){m=+e.target.value,z()})),document.querySelector("#joint-number").addEventListener("input",(function(e){d=+e.target.value,z()})),document.querySelector("#loop-number").addEventListener("input",(function(e){i=+e.target.value,z()})),document.querySelector("#ellipse-width").addEventListener("input",(function(e){D()})),document.querySelector("#ellipse-height").addEventListener("input",(function(e){D()})),document.querySelector("#loop-width ").addEventListener("input",(function(e){"ellipse"===s&&(i=+e.target.value,D())})),document.querySelector("#joint-width").addEventListener("input",(function(e){"ellipse"===s&&(m=+e.target.value,D())})),document.querySelector("#joint-number").addEventListener("input",(function(e){"ellipse"===s&&(m=+e.target.value,D())})),document.querySelector("#loop-number").addEventListener("input",(function(e){"ellipse"===s&&(i=+e.target.value,D())})),document.querySelector("#ellipse-orientation").addEventListener("input",(function(e){document.getElementById("ellipse-orientation-display").textContent=e.target.value,D()})),document.querySelector("#ellipse-extent").addEventListener("input",(function(e){document.getElementById("ellipse-extent-display").textContent=e.target.value,D()})),document.querySelector("#line-height").addEventListener("input",(function(e){"line"===s&&F()})),document.querySelector("#loop-number").addEventListener("input",(function(e){console.log("Loop number changed"),"line"===s&&F()})),document.querySelector("#loop-width").addEventListener("input",(function(e){console.log("Loop width changed"),"line"===s&&(F(),console.log("Loop Width:",c),U())})),document.querySelector("#joint-number").addEventListener("input",(function(e){console.log("joint number changed"),"line"===s&&F()})),document.querySelector("#joint-width").addEventListener("input",(function(e){console.log("joint width changed"),"line"===s&&(F(),console.log("Joint Width:",m))})),document.querySelectorAll('input[type="number"]').forEach((function(e){e.addEventListener("mousedown",(function(t){if(e.classList.contains("data-input")&&!confirm("Do you want to override the data-driven value with your custom input?"))return t.preventDefault(),!1}))}));var R={};function H(e){e.preventDefault();var t=e.dataTransfer.getData("text/plain"),n=e.dataTransfer.getData("text/columnHeader"),o=e.target.closest("input");if(o){o.value=t,o.classList.add("data-input");var a=o.nextElementSibling;a&&a.classList.contains("column-header-indicator")||((a=document.createElement("span")).className="column-header-indicator",o.parentNode.insertBefore(a,o.nextSibling)),a.textContent=n,o.style.width="calc(100% - ".concat(a.offsetWidth,"px)"),O(a,o),R[n]={id:o.id,operation:null,factor:null},M(o.id,t,{columnName:n}),console.log("Input value set to:",o.value),Y(),_(),console.log("Slider update functions called")}}function V(e){console.log("Drag End called"),e.target.classList.remove("highlighted-cell")}function O(t,n){t.addEventListener("click",(function(o){"factor-input"!==o.target.className&&function(t,n){var o;if(console.log("performValueAdjustment called for ".concat(n)),null!==(o=R[n])&&void 0!==o&&o.operation){console.log("Attempting to focus on .factor-input for ".concat(n));var a=t.parentNode;console.log("Parent node:",a),console.log("Children of parent node:",a.children);var r=a.querySelector(".factor-input");r?(console.log(".factor-input found for ".concat(n,", focusing now.")),r.focus()):console.log(".factor-input not found for ".concat(n,", unable to focus."))}else{var l=prompt('Enter operation (multiply/divide) and factor for "'.concat(n,'":'),"multiply 2");if(l){var i=e(l.split(" "),2),c=i[0],d=i[1];!function(e,t,n,o){R[t]={id:e.id,operation:n,factor:o,originalValue:parseFloat(e.value)};var a="multiply"===n?R[t].originalValue*o:R[t].originalValue/o;e.value=a,M(e.id,a,{columnName:t}),function(e,t,n,o){console.log("updateOperationText called",{columnHeader:t,operation:n,factor:o});var a=e.nextElementSibling;console.log("Existing columnIndicator:",a),a&&a.classList.contains("column-header-indicator")||(console.log("Creating new columnIndicator"),(a=document.createElement("div")).className="column-header-indicator",e.parentNode.insertBefore(a,e.nextSibling));var r=a.querySelector(".factor-input");console.log("factorInput before update:",r),r?(console.log("Updating existing factorInput value"),r.value=o):(console.log("Creating new factorInput"),(r=document.createElement("input")).className="factor-input",r.type="text",r.value=o,r.addEventListener("change",(function(o){console.log("Factor input changed:",o.target.value);var a=parseFloat(o.target.value);isNaN(a)?console.log("New factor is NaN. No update performed."):(console.log("Updating operation with new factor:",a),function(e,t,n,o){var a,r=(null===(a=R[t])||void 0===a?void 0:a.originalValue)||parseFloat(e.value),l="multiply"===n?r*o:r/o;e.value=l,R[t]={id:e.id,operation:n,factor:o,originalValue:r},M(e.id,l,{columnName:t});var i=e.nextElementSibling;i&&i.classList.contains("column-header-indicator")&&(i.textContent="".concat(t," ").concat("multiply"===n?"*":"/").concat(o))}(e,t,n,a))})),a.appendChild(r));var l=a.firstChild;l&&l.nodeType===Node.TEXT_NODE||(console.log("Creating new operationText node"),l=document.createTextNode(""),a.insertBefore(l,r)),console.log("Updating operation text node value"),l.nodeValue="".concat(t," ").concat("multiply"===n?"*":"/")}(e,t,n,o),Y(),_()}(t,n,c,parseFloat(d))}}}(n,t.textContent)}))}function M(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};switch(e){case"poly-sides":r=+t;break;case"size":l=+t;break;case"loop-number":i=+t;break;case"loop-width":c=+t;break;case"joint-number":d=+t;break;case"joint-width":u=+t/2;break;case"ellipse-width":case"ellipse-width":ellipseWidth=+t,"ellipse"===s&&D();break;case"ellipse-height":case"ellipse-height":ellipseHeight=+t,"ellipse"===s&&D();break;case"line-height":lineHeight=+t,"line"===s&&F();break;case"radius":z();break;default:return void console.error("Unhandled input id: ".concat(e))}W(),j(e,"".concat(n.rowName,"'s ").concat(n.columnName,": ").concat(t),!0)}function w(e){e.preventDefault()}function W(){if(g.selectAll("*").remove(),console.log("Drawing visualization for:",s),"polygon"===s)for(var e=0;e<i;e++)N(r,l+c*e,e%2*(1/(2*d)));else"circle"===s&&z();"ellipse"===s?D():"line"===s&&F(),U()}function U(){console.log("Function updateInstructionWithSize called");var e=g.node().getBBox();console.log("Bounding Box:",e);var t=(e.width/f).toFixed(2),o=(e.height/f).toFixed(2);!function(e){var t=document.getElementById("sizeIndicatorRange"),n=document.getElementById("sizeIndicatorValue");if(t){var o=e/parseFloat(t.getAttribute("max"))*100;t.value=o;var a=Math.round(o);n.textContent=a}else console.error("Size indicator slider not found");!function(){var e=document.querySelector(".instruction-box");e.querySelectorAll(".warning").forEach((function(e){return e.remove()})),c<10&&(console.log("Adding narrow loop warning"),X(e,"The loops are too narrow and they may burn in laser cutting. Consider increasing their size.")),m>20&&X(e,"The joints are too wide and leave minimal space for expansion."),d>30&&X(e,"There are too many joints and they leave minimal cut area.")}()}(Math.max(t,o));var a="Size: Width: ".concat(t," cm, Height: ").concat(o," cm");console.log("Size Info:",a),n.textContent=a;var r=n.parentElement;r.querySelectorAll(".warning").forEach((function(e){return e.remove()})),(t>50||o>30)&&X(r,"Zoom out to see the whole pattern. To adjust pattern size, consider remapping by dividing the values in variable section!"),c<10&&X(r,"The loops are too narrow and they may burn in laser cutting. Consider increasing their size."),m>20&&X(r,"The joints are too wide and leave minimal space for expansion."),d>20&&m>10&&X(r,"There are too many joints and they leave minimal cut area."),g.append("rect").attr("x",e.x).attr("y",e.y).attr("width",e.width).attr("height",e.height).attr("stroke","none").attr("stroke-width","3").attr("fill","none")}function X(e,t){var n=t.replace(/[^a-zA-Z0-9]/g,"-").toLowerCase(),o=e.querySelector('[data-warning="'.concat(n,'"]'));o||((o=document.createElement("span")).textContent=t,o.style.color="red",o.setAttribute("data-warning",n),o.classList.add("warning"),e.appendChild(o))}function J(){var t=document.querySelectorAll("#dataset-table tr th:first-child");0!==t.length?t.forEach((function(t){t.addEventListener("click",(function(){console.log("Row header clicked: ".concat(t.textContent)),function(t){document.querySelectorAll("#dataset-table tr:not(:first-child)").forEach((function(e){e.classList.remove("active-row"),e.classList.add("inactive-row")}));var n=t.parentElement;n.classList.add("active-row"),n.classList.remove("inactive-row");var o=function(e){var t={},n=document.querySelectorAll("#dataset-table th");return e.querySelectorAll("td").forEach((function(e,o){var a=n[o+1].textContent;t[a]=e.textContent})),t}(n);Object.entries(o).forEach((function(n){var o=e(n,2),a=o[0],r=o[1],l=R[a];if(l){var i=document.getElementById(l.id||l);if(i){var c=parseFloat(r);if(l.operation){var d=l.operation,u=l.factor;c="multiply"===d?c*u:c/u}i.value=c,M(i.id,c,{rowName:t.textContent,columnName:a}),Y(),_()}}}))}(t)}))})):console.log("No row headers found to attach listeners to.")}function Z(e){return Math.max(0,Math.min(e,100))}function Y(){var e,t,n=(e=1*parseFloat(document.querySelector("#size").value||document.querySelector("#radius").value)+2*parseFloat(document.querySelector("#loop-number").value)+-.5*parseFloat(document.querySelector("#loop-width").value)+-1*parseFloat(document.querySelector("#joint-number").value)+-1*parseFloat(document.querySelector("#joint-width").value),t=Math.max(0,Math.min(e,100)),console.log("Expandability score:",t),t);n=Z(n);var o=document.getElementById("stiffnessFlimsinessRange"),a=document.getElementById("stiffnessFlimsinessValue");(o.value==o.min&&n>o.min||o.value!=o.min)&&(o.value=n,a.textContent=n),o.disabled=!0}function _(){var e=(1-parseFloat(document.querySelector("#joint-number").value)/40+(1-parseFloat(document.querySelector("#loop-number").value)/50)+parseFloat(document.querySelector("#joint-width").value)/20+parseFloat(document.querySelector("#loop-width").value)/50)/4*100;e=Z(e);var t,n=document.getElementById("countabilityRange"),o=document.getElementById("countabilityValue");n.value=e,o.textContent=(t=e)<=20?"Very Challenging":t<=40?"Challenging":t<=60?"Moderate":t<=80?"Easy":"Very Easy",n.disabled=!0;var a=n.cloneNode(!0);n.parentNode.replaceChild(a,n)}document.querySelectorAll(".column-header-indicator").forEach((function(e){O(e,e.previousElementSibling)})),document.querySelectorAll("#dataset-table td").forEach((function(e){e.setAttribute("draggable","true"),e.addEventListener("dragstart",P)})),document.querySelectorAll("input").forEach((function(e){e.addEventListener("input",(function(){console.log("Input ".concat(e.id," changed to ").concat(e.value)),e.classList.remove("data-input"),e.classList.add("manual-input")}))})),document.querySelector("#shape-selector").addEventListener("change",(function(e){I(),console.log("Shape changed to:",e.target.value),s=e.target.value;var t=document.getElementById("polygon-container"),n=document.getElementById("circle-container"),o=document.getElementById("ellipse-container"),a=document.getElementById("line-container");switch(t.style.display="none",n.style.display="none",o.style.display="none",a.style.display="none",s){case"polygon":t.style.display="block";break;case"circle":n.style.display="block";break;case"ellipse":o.style.display="block";break;case"line":a.style.display="block";break;default:console.error("Unhandled shape type: ".concat(s))}g.selectAll("*").remove(),function(e){switch(e){case"circle":document.getElementById("radius").value,z();break;case"polygon":N(parseInt(document.getElementById("polygon-sides").value,10),parseFloat(document.getElementById("polygon-radius").value));break;case"ellipse":document.getElementById("ellipse-width").value,document.getElementById("ellipse-height").value,D();break;case"line":F()}U()}(s)})),document.querySelector("#datasets").addEventListener("change",(function(e){if("default"!==e.target.value){var t="../".concat(e.target.value,".json");console.log("Attempting to load:",t),d3.json(t).then((function(e){!function(e){var t=document.querySelector("#dataset-table");t.innerHTML="";var n=Object.keys(e[0]),o=document.createElement("tr");n.forEach((function(t,a){var r=document.createElement("th");r.textContent=t,0!==a&&r.addEventListener("click",(function(){return handleHeaderClick(t,a,e,n)})),o.appendChild(r)})),t.appendChild(o),e.forEach((function(e,o){var a=document.createElement("tr");n.forEach((function(t,n){var o;0===n?((o=document.createElement("th")).textContent=e[t],o.addEventListener("click",(function(){console.log("Row header ".concat(e[t]," clicked"))}))):((o=document.createElement("td")).setAttribute("data-column-header",t),o.setAttribute("draggable",!0),o.addEventListener("dragstart",P),o.addEventListener("dragend",V)),o.textContent=e[t],a.appendChild(o)})),t.appendChild(a)})),J()}(e)}))}else document.querySelector("#dataset-table").style.display="none"})),document.querySelectorAll('.controls input[type="number"]').forEach((function(e){e.addEventListener("dragover",w),e.addEventListener("drop",H)})),document.querySelectorAll("#dataset-table tr:not(:first-child) th:first-child").forEach((function(e){e.title="Hover to see options",e.addEventListener("mouseenter",(function(){var t=e.textContent;e.title="Apply same mapping to ".concat(t)}))})),J(),document.querySelectorAll(".input-field").forEach((function(e){e.addEventListener("input",(function(){Y()}))})),window.onload=Y,document.getElementById("sizeIndicatorRange").addEventListener("input",(function(){document.getElementById("sizeIndicatorValue").textContent=this.value})),document.addEventListener("DOMContentLoaded",(function(e){document.getElementById("stiffnessFlimsinessValue").textContent=document.getElementById("stiffnessFlimsinessRange").value,document.getElementById("countabilityValue").textContent=document.getElementById("countabilityRange").value})),document.querySelectorAll(".input-field").forEach((function(e){e.addEventListener("input",(function(){_()}))})),window.onload=function(){var e=document.getElementById("stiffnessFlimsinessRange");document.getElementById("stiffnessFlimsinessValue").textContent=e.value;var t=document.getElementById("countabilityRange");document.getElementById("countabilityValue").textContent=t.value,document.querySelectorAll(".input-field").forEach((function(e){e.addEventListener("input",(function(){Y(),_()}))})),Y(),_()},J(),document.getElementById("downloadButton").addEventListener("click",(function(){var e,t,n,o;e=document.querySelector(".design svg"),t=(new XMLSerializer).serializeToString(e),n="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(t))),(o=document.createElement("a")).setAttribute("href",n),o.setAttribute("download","downloaded_pattern.svg"),document.body.appendChild(o),o.click(),document.body.removeChild(o)})),document.querySelector("#poly-sides").addEventListener("input",(function(e){var t=+e.target.value;t<3?displayError("Polygon must have at least 3 sides."):(clearError(),r=t,W())})),document.querySelector("#size").addEventListener("input",(function(e){var t=+e.target.value;t>=2&&t<=1e5&&(l=t,W())})),document.querySelector("#loop-number").addEventListener("input",(function(e){var t=+e.target.value;t>=0&&t<1e3&&(i=t,W())})),document.querySelector("#loop-width").addEventListener("input",(function(e){var t=+e.target.value;t>1&&t<200&&(c=t,W(),U())})),document.querySelector("#joint-number").addEventListener("input",(function(e){var t=+e.target.value;t>=0&&t<100&&(d=t,W())})),document.querySelector("#joint-width").addEventListener("input",(function(e){var t=+e.target.value;t>1&&t<=50?(m=t,W(),U()):t>50&&X(document.getElementById("instruction-box"),"The joints are too wide and leave minimal space for expansion.")})),window.addEventListener("resize",(function(){x(),W()})),tippy("th",{content:function(e){return e.getAttribute("data-tippy-content")},placement:"top",allowHTML:!0,animation:"scale",arrow:!0})}))})();
//# sourceMappingURL=index.bundle.js.map